# 吹爆！2023B站公认最系统的Python金融分析与量化交易实战教程，3小时入门AI量化交易，看完还学不会你来打我！人工智能｜机器学习｜时间序列｜股票预测 - P42：3-获取因子指标数据 - 人工智能博士 - BV1aP411z7sz

这里咱们现在已经把所有的工具包全部给导进来了，接下来咱们就用这些工具帮我们去完成，我们因此分析的任务就行了，这里你看这个AlphaLearns当中，然后导进来几个模块，Utils是一会帮我们处理数据的。

然后Plotting是帮我们去画图的，然后下面俩是帮我们一会做分析的，这是一会咱用到的，然后因此分析咱名字改过来了，行了在这里咱们写吧，那么来想一想这个跟之前咱的一个回测框架不太一样。

回测框架当中有一个Handlebar，那是每天都可以去执行一些事，但是你看这里，咱们现在这个模块当中有每天去执行那一说吗，好像没有到吧，那我要干什么，我师傅现在得把很多天数据取出来。

他没法每一天帮我取每一天再帮我取吧，那咱们得怎么办，我得自己来去写了，咱们先写一下，第一步我们要选择一个日期数据，选择日期数据，什么叫选日期数据呢，你接下来要取。

比如说一个从19年1月1号到20年1月1号的，你得把这部分日期取出来，因为一会儿咱们在查询的过程当中，你得把日期传进去，咱才能查询出来相应的一个结果吧，好了，咱们写一下第一个函数，叫做我们去获取一下。

获取咱们的一个trading data，我们的一个所有的交易的不是data是一个dates，就是一个日期，日期当中有两个参数，第一个参数就是从哪年，比如说从这个2019年吧，然后1月1号。

然后接下来第二个参数到哪一年，到这个2020年，然后他的一个1月1号，哎，这个完事了，然后给他指定一个防御值，额，这就是咱们现在要用到的所有的日期，没写完一步，咱都来看一看。

因为也不确定这个东西写的对不对，来检查一下，没问题是吧，好了，这是咱们现在指定好了，我需要的一个时间段当中，都有哪些个交易日，咱们现在全拿出来了，接下来呢，我们是不是说要获取交易数据指标了，好了，获取。

获取因子指标吧，因子指标，因子指标怎么获取，是不是我们要做这样一个查询的操作了，好了，查询操作当中，你先告诉我，你要去查这个因子，他叫什么名字，这个倒是大家你们可以随便玩。

咱就拿这个P/E ratio来当做我们的一个指标，得了，随便选一个，然后接下来，那你说我现在是不是说，得在所有的股票当中，去把这个因子拿出来，那好了，咱们就把股票拿出来，这里我们也不做限制了。

回头A果咱就直接的全部拿出来，然后一会儿咱把这些因子都给他打印出来，然后咱们来分析分析，看看哪些因子，看看这个因子在不同股票当中，它的一个指标怎么样，我们先把所有的00300给他全部先拿到手。

Try SHD，行了，这是我们现在怎么样，把所有的股票咱现在都拿到手了，然后指定个名字吧，这就是我现在的一个股票池子，这是我现在有的一个股票，然后呢，有了股票之后，我们是不是要做一个查询操作，查什么。

查基于Fundamentals当中，去查一下，当前我这个指标来说，它的一个各种各样的一个情况吧，这块，哎呀，这块这个太长了，我直接的去复制吧，打开一下咱们的一个帮助文档，我们去对Data获取是吧。

点第一个，然后呢，这里它就是有所有的API，再找啊，就是现在我要去这儿呢，我们去查询一些它的数据，然后这块我也不用看字段了，我就图方便了，咱直接把这个东西复制过来就行了，这就是我当前的Query语句。

我直接复制了，然后复制到哪儿我看看，复制到这里就行，哎，我要的所有的指标行，再拿过来实在记不住啊，这东西实在太长了，好了，咱来指定一下，这个就是我要查询指标，我说指定一个Q，Q呢等于一个Query。

我到这里去查，它当前的一个P指标，然后呢，对于这个P指标，咱可以给它做一个filter，就是看一看，它是不是啊，在我的一个谷要试当中，咱来写一下，这些写挺长，点filter一下，filter当中啊。

还是得把当前的这个传递来，我把当前的这个东西直接的复制吧，太长了，这个名字把它复制过来，然后呢，看一下当中它的什么，它的一个代码的名字是吧，我看看，它这个style code当中，有没有一个杠，啊。

这呢是吧，这是有一个杠的，把它给它复制过来，行了，把它的一个code，啊，没有杠，把它的一个code复制过来，然后呢，去判断一下，它的一个股票是否啊，是在我当前的这个池子当中。

我的池子刚才定义好名字了吧，好了，在这给它复制过来，传进去，这就行了，这里给大家看了一下，就是当前我们的一个查询语句，那做完这个查询语句之后，接下来，我们是不是说，哎，你得执行这样一个找的操作才行啊。

好了，我们另起一毫，在这里，呃，执行找操作直接复制了，这里直接get一下，get一下咱们当前数据，然后我的一个查询，我说这是个q，我给它传进来，这就行了，不光你要告诉我传来一个q，你还要告诉我什么，哎。

你的一个查询日期吧，日期咱刚才是不是指定了，好了，指定日期，哎呦，但是这个日期，它是一个，它是一个区别是吧，咱得查询某一天，这样吧，咱就查询某查询第零天吧，先试一试，结果对不对啊，先把数据拿到手。

然后指定返回值，这个就是我们查询的结果，每一天的我们去查的一个factor，它的一个data数据，行了，然后这样咱们执行一下，呃，哦，这执行完没问题是吧，不要看这个一些警告，警告跟他没关系。

只是平台他的一些问题，咱不用去管，然后这里咱们拿到这个数据，拿到这个数据之后啊，嗯，咱来看一看吧，这个数据当中也指标，我说。iloc一下，看一下，iloc当中，iloc当中，我需要先看一下吧。

它的一个shape值啊，这个需要给大家解释一下，它的shape值稍微的有一点不一样啊，你看什么，它是个三维的，但实际上来说只有最后一个维度，它是有数据的吧，前两个没什么用啊，咱都不用去管这个事，好了。

那我说前两个那默认就是零零，然后接下来最后一个维度，我说我看这么五条数据吧，来执行一下，现在有什么了，是不是说哎，这是一个咱的股票数据，然后这个是他的一个就是具体指标，它是零多少，咱们现在是拿到手了吧。

大家可能说这怎么没有一个日期啊，因为这里边当你传的过程当中，是不是你就只写了当前的某一天，第一天那天2019年的1月2号吧，这是当前对于特定的一天，咱把这个指标给拿出来了，但是让我们来想一想。

现在我们要做什么，那现在我在这写一下，我们现在完成的，现在完成就是获取指定日期吧，指定日期的数据啊，咱们已经会了怎么样去做，那现在呢，我们要做什么，我要把这一段的时间。

全部的给他做出来吧。

![](img/f35df35844b8f7fff01a587e322ce502_1.png)

那这个东西咱们该怎么去做呀。