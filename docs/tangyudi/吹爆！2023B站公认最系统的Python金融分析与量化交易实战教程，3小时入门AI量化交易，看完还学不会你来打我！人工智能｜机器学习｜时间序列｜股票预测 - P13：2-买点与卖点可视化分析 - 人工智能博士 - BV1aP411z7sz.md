# 吹爆！2023B站公认最系统的Python金融分析与量化交易实战教程，3小时入门AI量化交易，看完还学不会你来打我！人工智能｜机器学习｜时间序列｜股票预测 - P13：2-买点与卖点可视化分析 - 人工智能博士 - BV1aP411z7sz

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_0.png)

好了，我们第一步导进来，咱们当前所需要的这些工具包，能安排pandas maplot啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_2.png)

这不用说了，咱把之前的全复制过来就行了，然后呢读数据啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_4.png)

还是啊，我们之前的那个data点CSV指定我们的索引，第一列是什么，第一列索引就是咱们当前选的哎那个时间是吧。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_6.png)

然后把时间解析一下啊，然后把这个结果拿到手了，拿到之后一会儿我选择股票啊，这里头有几个股票是吧，咱就拿这个苹果这个股票来当例子。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_8.png)

给大家做这样一个实验，然后这个UFO咱也不用去看了。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_10.png)

这是咱的一个数据好了，我们完成这样几个事来看一下吧。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_12.png)

咱们要做的事啊，首先第一件事儿啊，你说我们要去选择苹果的股价，并且呢在咱之前在做力的时候，是不是说可能有问题，什么问题，数据当中可能会存在缺失值吧，一存缺失值诶，你做一些实验窗口的时候可能会有些问题吧。

所以说咱们在预处理的第一个阶段先干什么，把缺失值全部的给它去掉吧，啊这个是我们要去做的一件事儿行了。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_14.png)

在这块我们先把这个数据拿到手，我说这个data啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_16.png)

我把这个data拿到手吧，等于什么呢，等于我把我当前的数据也传进来呃。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_18.png)

我只需要一列就行了，就是苹果的这一列吧。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_20.png)

好了，把苹果这一列名字我给它复制过来，然后呢，接下来啊，现在把这个列我有了，然后干什么哦，不要忘记我们要去去掉这个缺失值吧。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_22.png)

再做一个DPA嗯，然后我打印一下这个data data。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_24.png)

点head一下行了，我们现在出去就了，这个不就是，但现在我想要的份数据吗，啊只有苹果这个骨架了，第一个字咱做完了，非常简单吧啊。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_26.png)

先做了一个缺缺失值，第二步计算我短期和长期的一个均线，那短期和长期，第一步你是不是先告诉我这个短期咱要多少天，这个长期咱要多少天吧，好了，我来写一下一个短期，然后呢再来一个长期。

这里这样就是短期和长期啊，咱给他写的稍微的大一点。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_28.png)

因为咱们这个数据啊，你看哦这个看不出来这个数据咱一共多少条。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_30.png)

有这么2000多条，大概是得有个78年的一个数据了。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_32.png)

所以说在78年数据当中啊，呃如果你这两个值指令太小了，在咱图当中画的那就太不清楚了，所以说我先把这两个指标值啊，画的稍微的大一点啊，再来看，正常就是短期可能五天比较常见，长期是二点比较常见。

但是我刚才说了，咱们任务相对来说数据量比较多，我把这个数值稍微的设置那么大一点啊，咱好观察行，第一步，我先把这个短期和长期的一个时间设出来了，那接下来呢接下来我们是要算这个均线了。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_34.png)

或者说算这个走势了，这该怎么算啊，在咱们当前的我的这个数据当中，我是不是要对这个数据做什么，做一个各种窗口吧，得把好多窗口全做出来吧，好了，把我当前的一个短期先传进去，这是我窗口的大小吧。

每个窗口算什么，哎，咱该说的比如这都是收盘价，算收盘价是什么值，是不是一个均值啊，在这里我再点名一下，把这个均值拿到手是不行了，然后这里我说我计算了一下呃，然后计算完之后。

我把这个结果回传到咱当前的data frame当中，并且给他指定个名字，可以吧好了，让我们来实现一下哦，直接完之后哦，把下面也执行吧，下面就是第二个，然后这个改成一个二就得了。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_36.png)

执行两次呃，我看下这块出现出现一个小问题呃，这个KIL原因啊，是因为现在啊，当我把这个数据就是加了一列之后，前列数据当中不是有两列吗，有两列数据，然后再做这个rolling的时候，你就得去指定好了。

你对谁来去做这个rolling这样一件事吧，因为现在我们数据当中它就不是有这么一列了。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_38.png)

所以我得给它指定出来，就是在数据当中啊，我对呃。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_40.png)

我看的名字啊，对我的苹果的股价把这位多加一步，其实正常情况下在上面多加一步也行啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_42.png)

然后再执行一下啊，行没问题了，然后呢看一下我们当前这个数据点head一下啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_44.png)

这边会出现好多确实指示吧，那也正常，因为前面几个窗口。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_46.png)

你得最少得有42窗口才能有这样一个值吧，好了，点tail一下吧。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_48.png)

TAO当中我们是不是能把它的一个短期，还有SM1短期啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_50.png)

这个A2它是一个长期是吧，好了，这一步我完成了，就是分别在计算了一下这个短期还有长期均线。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_52.png)

我们的一个结果，然后若是大家想画图案也很简单。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_54.png)

你可以画图展示一下，对我这个data data当中啊，你不是有这些指标吗，对于data我直接的，我去点plot一下不就行了，不过当中你去指定一下这个图它的一个大小啊，咱指定的稍微这么大一点，看结果吧。



![](img/c1eb1f9b1eedf89c058f1823ab8fc725_56.png)

好了，这图是不是有了，你看这个图当中啊，是不是发现了一些事儿啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_58.png)

咱可以来分析分析啊，他是不是有几个焦点，你看我们先来看这个红色的，就是原原始骨架，咱就不看了啊，咱就看这个短期和长期，然后有这个红色的，还有这个绿色的，然后呢找一找吧，我们当前这个红色的诶。

这里红色的和绿色当中啊，会有一些点吧，那这些个点，是不是都是我们需要考虑的一些对象了，来看第一个点，第一个点绿色的，我的短期均线跟长安剧院就交叉了，并且箭头往哪儿的，往下的说明干什么了。

你说此时哎咱们是该买还是该卖啊，这是什么，这是死亡，这是死亡交叉吧，该卖了这个东西，然后再看一看，我看有没有网上的哦，找一找在这里这个位置，这个位置可能不太明显，来看一看这个位置吧，这个位置挺明显的。

这位置怎么样了，交叉完了怎么样，是要涨了吧啊这块就是我们的一个黄金交叉。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_60.png)

我们的一个买点吧，好了给大家看了一下，就是在这张图当中。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_62.png)

我们已经能够显示出来了，当前一些啊，我们的一个结果呢。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_64.png)

然后这个数据咱再处理处理吧，上面咱之前看的时候怎么样了，是不是有很多个缺失值啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_66.png)

所以说咱得把缺失值一会儿再去掉，我看第三问啊，第三问就是做一个标记。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_68.png)

标记了一下这个短期和长期经验的位置关系。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_70.png)

其实说白了就是啊你给我指定的标志位，有position，表示的是你这个短期均线是大于长期均线，还是一个小于那个长期均线，然后做这个之前咱得把缺失值去掉，刚才是给大家看了数据当中啊。

我们的缺失值还是挺多的，我不用就是要不然你写这个东西，然后等号等一个data，要不然你在这边写上就是一个呃1place等一个true，相当于在原始数据当中执行这样一次修改的，操作好了，去掉一个缺失值。

然后呢在代码当中，我们的问题不是说你指定一个标志位嘛，然后通过这个标志位表示的是当前啊，我们的一个位置，它是就是短期的是大于长期的，还是小于长期的，安排，点view一下V当中，喊你去指定一下当前爱。

在我的这个电影当中算一下吧。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_72.png)

啊我们的一个短期把这个直接复制过来，我们这个短期的和长期的之间的关系，短期的是否是大于这个长期的位置当中啊，有三个参数，第一个参数就是判断，第二参数就是满足条件下反问什么。

第三个参数不满足条件下返回什么。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_74.png)

指定一下就可以了好了，直接完之后来去点HD一下。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_76.png)

看结果点还得下，你看这里咱们多了一个标志位吧，好了，我们短期的长期的标志位是不是都有了，标志位为一的代表什么，这不就是我们的一个短期是大于咱的一个长期，你看从数值上也是我们当前的这样一个结果吧。

然后这个图其实也能画出来啊，咱之前说的全系列的时候，我其实好像说过这个东西，对我们data你可以去点LTE下DEPLOG当中呢，然后呃咱之前说的时候是不是说你得去画什么，得去画第二个轴吧。

要不然这个结果啊，sexy sey当中啊，然后你去指定一下这个Y轴呃，这两个Y这个Y轴，然后用谁来当做是比较合适的，把这个复制过来，reposition好，这就行了，然后指定图也是稍微大一点。

feature size等于一个十逗号六。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_78.png)

来看一下吧，这个是不是咱们当前的结果，像之前瑞达画过了，那好了。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_80.png)

那我现在咱们要做一个策略了，做什么策略呢，哎呀你说这个股票如果呃我就什么都不管。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_82.png)

就是从我从我这个最菜最早的一个点买进来了，我就不管了，然后到最后这个18年一八年中旬的时候吧，我说我把它卖掉，我看一下之前的一块钱，相当相当于现在几块钱啊，这是什么都不管的前提下。

那现在啊你说我们还应该什么都不管吗，好像不应该了吧，为什么，因为我们之前是不是一种策略了，我可以怎么样，有的时候我可以卖掉，有的时候我可以再买进是吧，好了，那我们来想一想。

如果在这个时候我们能把这件事做出来，是不是相当于咱能保证什么，始终我是一个盈利的状态啊，比如这时候这样，这个时候都在这个点的时候，比如说现在你有这么100块，就是假设吧，你的总值是100块钱。

然后你去给他这说，这说咱们应该怎么样给他卖掉吧，然后这块的时候如果它变成80块钱，你再买进来，那什么意思啊，那是不是说这个时候礼拜底你还是赚了20呀，是不是这样一件事啊，就是这里这个意思啊。

不是说他现在这个往下走了，就是咱是稳赔的，因为咱刚才设计策略了嘛，我可以怎么样，我可以在这个这一点就得卖掉，然后下一个点我再也得买进就完事儿了，咱刚才不是说了吗，能说能计算出来哪个点该买，哪个点该卖。

所以说啊就是呃永远都是什么，按照咱们这个策略来说，相当于开挂似的，你事先能先知啊，按照咱们的策略来说，就是永远都是盈利的，因为正常情况下，你看什么都不管，这100变80应该是亏20吧。

但是呢我们反而怎么样，我们在这点卖了，在这里买进来，我们反而怎么样，赚了20吧，哦是这个意思。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_84.png)

所以说一会儿啊咱们会一直转下去啊，咱们来看一看，就是你什么都不管啊的时候，咱这最终的一个报酬率啊，或者说一块钱能等于现在多少钱，以及我按照咱之前设计的，我们的一个就是买点和卖点。

咱都能通过这个双双均线也算出来吧，然后来看一看我自己设计系统，哎咱们能够一块钱最终赚多少钱啊。

![](img/c1eb1f9b1eedf89c058f1823ab8fc725_86.png)