# P174：7-GMM高斯混合模型聚类使用代码举例 - 程序大本营 - BV1KL411z7WA

来，那接下来呢咱们这个算法原理。

![](img/59405528524733872b71504340c60ba4_1.png)

我们也进行了讲解，是不是，咱们接下来就使用一下我们的高斯混合模型，咱们看一下是吧，他这个到底如何使用的，和咱们之前学到的聚类算法有啥不一样好，那么高斯混合模型是一个用于聚类的概率模型。

他使用了em算法进行迭代，那么咱们的高斯混合模型，假设每个簇的数据都符合高斯分布，看到了吧，你看他这做了一个假设，是不是假设咱们这个数据呢它是正态分布的，对不对，那最好呢你的数据就是正态分布的。

你正好吻合了，你想一下，你得到的结果是不是才是最合适的呀，对不对，分类的效果才是最好的，嗯那咱们就回到代码当中，我们使用一下这个高斯混合模型。



![](img/59405528524733872b71504340c60ba4_3.png)

来回到咱们的代码当中，好现在呢我们往下滑，咱们在这儿呢来一个三级标题，这个叫做j m m高斯混合模型。



![](img/59405528524733872b71504340c60ba4_5.png)

咱们使用一下它好，那么此时呢我们先导一下包，咱们import numpy as np from sk learn，咱们将数据集导进来，data set，然后画图工具我们导一下。

import matt plot，lib，piplot as plt from sk learn，咱们呢将模型导进来，我们先将k means导进来，这个算法导进来，然后呢from sk learn。

咱们从mixture当中，咱们将今天的主角叫做高斯mixture导进来，那我们导进来这个呢它就是高斯混合模型，大家注意这个模型呢，它是使用em算法进行的迭代优化。



![](img/59405528524733872b71504340c60ba4_7.png)

执行一下代码，现在咱们就导包成功了，然后呢我们就创建数据，咱们来一个四级标题，咱们在这儿呢去创建数据好，那么咱们就使用data set调用一下其中的方法，咱们来一个make blobs。

make blobs，咱们可以生成三类点，我们给一个n sample，咱们1500个点，然后给一个cluster s t d，这个cluster s t d就是每一类点它的标准差，标准差不同。

那么它的这个有的呢更加聚集一些，有的呢更加分散一些，咱们给一个一点，给一个2。5，然后呢给一个0。5，这三者三类的这个数据是不一样的，然后呢咱们再给一个random state。

random s t a t e，我们给一个170数据，咱们就创建好了，前面接收一下，那就是x和y来，此时呢咱们把这个数据给它画出来，看一下它是什么样的啊，这个时候呢咱们就plt。figure。

我们给这个数据一个尺寸，咱们呢给一个figure size，咱们给一个12和九，然后呢我们plt rc params，咱们设置一下它相应的属性，咱们给一个phont family，我们在画图的时候。

咱们给它中文的这个标题，那想要中文的标题，咱们给一个st楷体，字体大小也设置一下plt rc param中国号，我们给一个fat size，咱们让它呢等于20设置有了，然后呢咱们就p l t嗯。

嗯这个时候呢咱们就调用scanner s c，a t t e r，在这个当中呢把我们生成的数据放进去，零表示横坐标，一表示纵坐标，颜色呢我们给一个y，我们给他一个标题，那就是plt一点。

咱们调用title，那这个呢就是咱们的原始数据，我们给一个pad，pad就是间隔，咱们让这个间隔是20，此时你看我执行一下代码，咱们报错了，大家看这个就是咱们的语法错误，语法错误，我们2。5和0。

5之间应该是逗号，但是咱们书写的时候不小心写成底了，把这个点删除，咱们来一个英文的逗号，此时你看我一执行来。



![](img/59405528524733872b71504340c60ba4_9.png)

大家现在就能够看到，我们这个数据是不是就出来了呀。

![](img/59405528524733872b71504340c60ba4_11.png)

看到了吧，这个图片尺寸有点大，咱们调小一些好不好，咱们给一个四，给一个四，这个时候你看我一直行，这个四和四就有点小。



![](img/59405528524733872b71504340c60ba4_13.png)

咱们给一个六和六啊，执行一下来，现在你来看数据是不是就有了呀，看到了吧，这是分了三类啊，大家要注意，咱们分了三类，黄色的是不是一类紫色的，是一类绿色的，是不是一类呀，你要注意啊。

这个时候我们的小伙伴有没有发现，咱们一些底儿，你看到了吧，这个底还有这个底，它是不是完全在，你看它是不是完全在咱们黄色这个区域当中呀，对不对，但是呢这个绿色的点它依然属于绿色的这一类。

我们发现绿色的这一类底，它是不是比较分散呀，看到了吧，它比较分散，那请问我们刚才给他的这个cluster s t d的时。



![](img/59405528524733872b71504340c60ba4_15.png)

候，在给这个标准差的时候，一个是一点。

![](img/59405528524733872b71504340c60ba4_17.png)

一个是2。5，一个是0。5，那你告诉我哪一类哪一类点。

![](img/59405528524733872b71504340c60ba4_19.png)

它的这个它的这个标准差是2。5呢。

![](img/59405528524733872b71504340c60ba4_21.png)

黄色的还是咱们绿色的，还是咱们紫色的，来我们在讨论区里边儿，各位小伙伴，你回复一下这个问题啊。

![](img/59405528524733872b71504340c60ba4_23.png)

就是咱们2。5它对应哪一个是吧。

![](img/59405528524733872b71504340c60ba4_25.png)

对应哪一类点儿，好那么我们各位小伙伴回答的都是绿色是吧。

![](img/59405528524733872b71504340c60ba4_27.png)

哎那说明呢你对于标准差这个概念是理解的，这个标准差越大，这个数据呢就越离散啊。

![](img/59405528524733872b71504340c60ba4_29.png)

咱们刚才呢还要强调一个问题，也就是说咱们有一个绿色的点，你看好几个绿色的点，是不是都被咱们的黄色的点给覆盖了，对不对，你看他被黄色的点覆盖了，是不是还有咱们绿色的点儿，看到了吗。

它是不是也跑到咱们紫色的区域了，唉大家要注意啊，那我们这个生成的这个数据是吧，这个绿色的点，你看它确实属于绿色这一类，即使呢它和咱们黄色的点嗯在一起，那么也不能把它划归到黄色这一类。

你就好比咱们如果咱们这个进行宿舍划分的时，候，我们是不是不能根据身高进行划分呀是吧，那你那你像有的男生身高比较矮，他只有1米6，那我那么我们把它划归到女生宿舍里边儿，这合适吗，是不是不合适呀，对不对。

哎所以说你看你这个绿色的这个点是吧，那说明你的这个特征是吧，和它吻合，但是呢你并不属于蓝色，并不属于黄色这一类好。



![](img/59405528524733872b71504340c60ba4_31.png)

那么大家看啊，咱们的数据有了，那么我们就使用使用咱们的key means，看之前咱们就使用k means，我们使用k means算法，咱们使用聚类，我们呢就看一下效果。

k means就等于key means，现在呢咱们把它分成三类，啊分成三类，然后呢咱们就k means啊，此时我们就调用feat方法x放进去，然后k means点咱们调用transform，这个方法。

是不是就可以将它的类别数据给它拿到呀，得到的这个结果我们起个名叫歪盖，然后呢我们把这个画图给他画出来啊，来此时咱们画图画出来，那就是p t。scanner，那我们将数据放进去，x冒号零。

这个是数据x冒号一颜色呢咱们就用y盖，此时呢我们也给一个标题plt。title小括号，这个呢就是咱们k means，聚类的效果，然后逗号我们也给一个pad，咱们让它是20，此时来各位小伙伴来看一下呃。

rgb数的b0 到一range，咱们看一下咱们某一个地方给错了啊，来此时呢我们就发现啊，看咱们这个plt这个地方唉，现在你就能够看到这个地方报错了是吧，看我们transform这个方法用错了。

咱们呢应该用predict，这个predict是不是就是预测它的类别呀，啊此时我们已执行来。

![](img/59405528524733872b71504340c60ba4_33.png)

各位小伙伴，你就能够看到咱们聚类的效果是不是就出来了。

![](img/59405528524733872b71504340c60ba4_35.png)

看到了吧，此时聚类的效果出来了，看没问题啊，聚类的效果出来了，出来之后我们发现啊，咱们你看这个蓝色的这个你看它变成什么了，那蓝色的变成什么了，那其实我们聚类的时候呢，咱们的颜色呢可能是进行了一个翻转。

就是原来的时候，你看这个地方它是不是应该是看原来的时候，这个地方是是什么颜色，是不是黄色，中间这个是不是一个紫色呀对吧，这个时候呢我们预测出来这个y值，它和咱们原来的这个y。

在表现类别的形式上有点不一样，你看咱们原来的y啊，是110对吧，现在我们预测出来这个y呢，预测出来这个y杠是多少呀，看咱们就发现啊，预测出来这个歪盖是不是二零呀对吧，那这个时候我们就会发现。

其实呢是不是一和二进行了一个颠倒呀，看到了吗，其实就是一和二进行了一个颠倒，零是不是不变呀，那我们就可以这样操作啊，看为了我们，为了咱们让它的颜色能够有一个对应，你看咱们可以这样，我们让歪盖等等多少呀。

等等一看这个作为条件一，然后呢我们再来看c o n d c o n d2 ，我们让y盖，咱们让它等等二，你看这是不是两个条件，有了这两个条件，咱们对于y杠的一和二的数据进行一个反转。

c n d一呢我们把它变成二，然后y杠中括号c o n d2 ，咱把它变成多少，变成一，也就是一和二，咱们进行一个颠倒，这个时候你看我一执行呃，我看一下啊，这个时候颠倒过来之后呢。

呃咱发现这个嗯还是不太对是吧，大家看看还是不太对啊，我看一下啊，这个变成紫色了对吧，咱们这个就变成黄色了。



![](img/59405528524733872b71504340c60ba4_37.png)

我们看一下咱们原来这个数据啊，看原来这个数据啊。

![](img/59405528524733872b71504340c60ba4_39.png)

黄色绿色和紫色是吧，呃那等会儿啊来咱们再调一下啊，把这个变成零呃，我看看啊，y杠等等零，反正我们是咱们这样啊，零一然后来一个c o d3 ，让他y杠等等，咱们的二，反正你是不是就是012啊，对不对。

看吧反正就是012，现在的话咱们将这个数据呢，我们给它变换一下啊，歪盖中括号c o n d啊，咱们来一个c o n d3 ，看看我现在怎么去调整一下它啊，调整完之后呢。



![](img/59405528524733872b71504340c60ba4_41.png)

我们希望这个颜色表示是它和原来的，能够对应上，那012，现在的话咱们就嗯让这个呃t让他替换一下啊，这样啊看看咱们现在呢给个零和一好不好，就是把c n d2 也变成零啊，零和一。



![](img/59405528524733872b71504340c60ba4_43.png)

此时呢我执行一下来，现在各位小伙伴你就能够看到。

![](img/59405528524733872b71504340c60ba4_45.png)

如果说我们要两个都是零的话，现在我们就发现，你看这个颜色是不是就全是紫色了，对不对，你看它就全是紫色了，那我们在我们再给它一个值啊，咱们看一下到底哪个是紫色啊。



![](img/59405528524733872b71504340c60ba4_47.png)

那我们就知道这个零肯定是紫色。

![](img/59405528524733872b71504340c60ba4_49.png)

对不对呀，那咱们知道右下角这个是不是应该是零呀，现在呢我们再给个一啊，你看我再给个一嗯，嗯咱们再给个一的话。



![](img/59405528524733872b71504340c60ba4_51.png)

嗯等会啊我看一下啊，上面这个咱们给个一，下面这个呢嗯咱们给个二。

![](img/59405528524733872b71504340c60ba4_53.png)

后面给个零啊，我看看啊，调不过来了是吧。

![](img/59405528524733872b71504340c60ba4_55.png)

呃等会啊，这个是这个应该是紫色。

![](img/59405528524733872b71504340c60ba4_57.png)

绿色，蓝色是吧，现在你看呃没有调过来，现在咱们发现中间这两个是不是没调过来啊，那我们就看一下中间这个是对应着哪个颜色啊。



![](img/59405528524733872b71504340c60ba4_59.png)

我们把这个调整成一。

![](img/59405528524733872b71504340c60ba4_61.png)

咱们看一下啊，这个调整成一之后呢，咱们就发现是不是全变了，如果要调整成二。

![](img/59405528524733872b71504340c60ba4_63.png)

呃看一下啊，调整成二，后面这个是零，嗯后面这个是二，上面这个调整成零，看一下这个颜色的这个对应情况啊，执行一下，蓝色紫色啊，等会儿啊，我看中间的是绿色是吧，咱们想办法把中间给它调整成绿色啊。

哦我明白了咱们的k means这个算法，你想他每次执行和每次执行，是不是都不太一样呀，对不对，你看啊，来我们把这段代码注掉啊。



![](img/59405528524733872b71504340c60ba4_65.png)

看咱们就这样执行，看我们多执行几次，你你也会发现这个颜色呢，它也会有一个不一样的地方，看到了吗，这回是不是就这个就变成蓝色了，你看我再执行一下，看到了吗，中间是不是就变成绿色了，看到了吗，再执行一下啊。

你看再执行一下。

![](img/59405528524733872b71504340c60ba4_67.png)

你看再执行一下，咱们呃一定能够出来这种效果啊，再执行一下嗯，就是现在的话这个颜色是什么样的颜色。

![](img/59405528524733872b71504340c60ba4_69.png)

这个呢是无所谓的啊，咱们主要看一下聚类的效果呃，为什么咱们k means在执行的时候。

![](img/59405528524733872b71504340c60ba4_71.png)

它这个颜色会发生一个变化呢，是不是因为咱们k means的原理。

![](img/59405528524733872b71504340c60ba4_73.png)

大家仔细回想一下，咱们的中心点是不是随机选取的呀，对不对，这个中心点随机选取，所以说就会导致什么样的一个情况呀。



![](img/59405528524733872b71504340c60ba4_75.png)

颜色是不是也是随机的，但是咱们现在发现，他是不是也依然分成了三类呀。

![](img/59405528524733872b71504340c60ba4_77.png)

你看这个三类的效果，你会发现这个k means，是不是根据距离的远近进行划分的，所以我们就会发现看啊看啊，有一大批点儿本来属于是中间的，但是现在是不是都被划归到右侧这一类了，是不是。

看那也就是说咱们k means是如何划分的呀，看k means咱们是不是就是距离，是不是根据距离来进行划归类别呀，看咱们呢就就是根据距离来划归类别，对不对，你想这个时候。

他有没有考虑咱们样本的分布情况呀，没有对吧，很显然你看就是我们最右侧紫色的这一簇点，你看他们是不是仅仅的一簇点呀，那你你想一下，你就上面这个点看到了吧，离它是不是还挺远的对吧。

那很显然上面这个紫色的点和这一簇紫色的点，它们不是一类，为什么呀，嗯如果你要是一类的话，如果你要是符合整正态分布的话，你是不是应该是在它的周周围呀，对不对，但是这个就离得太远了。

但是呢我们根据什么进行划分的，k means，k means它只根据距离，所以说这个时候k means划分。



![](img/59405528524733872b71504340c60ba4_79.png)

咱们所创建的这个数据效果就不太好。

![](img/59405528524733872b71504340c60ba4_81.png)

那接下来咱们使用嗯，接下来呢咱们就使用gm m高斯混合模型，我们使用这个咱们呢来操作一下，我们看一下效果怎么样，此时呢声明gmm就等于gos mixture，里边呢我们给一个n components。

咱们呢把它分成三类，然后呢使用gmm点咱们feat predict，一步到位，将咱们的数据x放进去，返回的结果我们依然叫歪盖，这个就表示类别，此时呢咱们画图画出来啊，那就是plt呃，点scatter。

咱们将数据x放进去，零横坐标x中括号冒号一纵坐标，然后我们给一个颜色，颜色呢就是咱们高斯他预测出来的这个数据，给他一个标题，plt。title，那这个标题呢就是gmm咱们聚类的一个效果，也给一个pad。

让它呢距离咱们的图形有一个间隔。

![](img/59405528524733872b71504340c60ba4_83.png)

此时你看我一直行，来各位小伙伴，你看各位小伙伴，你看一下咱们画出来的这个聚类的这个效果，这个聚类的效果和，比咱们上面使用k means聚类的效果。



![](img/59405528524733872b71504340c60ba4_85.png)

是不是就好多了呀，看咱们的原始数据啊，你看这是原始数据，对不对，看到了吧，这是原始数据。

![](img/59405528524733872b71504340c60ba4_87.png)

没错吧，你看这个是不是咱们k means聚类的效果。

![](img/59405528524733872b71504340c60ba4_89.png)

这个是不是高斯聚类的效果，那我们那我们剧烈的这个效果呢，咱们如果说要是给它调整一下尺寸，plt。figure，这个当中给一个figure size。



![](img/59405528524733872b71504340c60ba4_91.png)

咱们也让它是六和六，这个时候看起来呢就效果就好一些了，看到了吧，你看啊，在这个当中有一个点儿，大家要仔细观察一下，就这个点儿，这个点儿你看我们聚类把它变成什么颜色了，是不是中间这个黄色呀强大吗。

这个高斯混合模型强大吗，如果要按照咱们key means，那这个点一定是不是被划归到咱们啊，一定是不是被划归到这个蓝啊，这个绿色这个区域啊，但是没有是吧，它是不是就变成黄色区域了是吧。

因为我们这三促点儿看，因为咱们这三类点儿啊，因为咱们的三类点它是什么分布呀，它是不是一个正态分布，所以说这个高斯聚类模型。



![](img/59405528524733872b71504340c60ba4_93.png)

就很好的把这个数据进行了划分，现在呢咱们将这个三个图画到一起。

![](img/59405528524733872b71504340c60ba4_95.png)

我们进行一个对比哈，好那么这个时候呢呃咱们就plt。figure，我们给它一个尺寸嗯，咱们给一个figure size啊，这个时候呢咱们给一个12和四，宽度是宽度是12，高度是四，然后呢p t一点。

咱们调用这个sub plot，咱们给一个一行三列，第一个唉，这个时候就有一个子视图了。

![](img/59405528524733872b71504340c60ba4_97.png)

首先呢我们绘制原始数据，往上滑。

![](img/59405528524733872b71504340c60ba4_99.png)

原始数据呢来，咱们呢把原始数据的绘制呢复制一下啊。

![](img/59405528524733872b71504340c60ba4_101.png)

放到这ctrl v，这个就是原始数据，然后呢plt。sub plot，咱们来一个一行三列，第二个，这个呢就是咱们使用k means聚类得到的结果，往上滑。



![](img/59405528524733872b71504340c60ba4_103.png)

找见咱们k means聚类，k means聚类在这呢复制一下这两行代码啊，不仅要复制这两行代码，同时咱们还需要把k means这个算法复制一下，他预测的结果叫歪盖也要复制来。



![](img/59405528524733872b71504340c60ba4_105.png)

那我们就在这粘贴一下，现在你看这个绘制的就是k means聚类的效果，最后呢plt。sub plot，添加子视图，一行三列，第三个，接下来咱们绘制就是高斯混合模型，复制一下这个代码，在这儿来一个粘贴。

此时我执行这个代码来。

![](img/59405528524733872b71504340c60ba4_107.png)

各位小伙伴你就能够看到一个对比的情况了啊。

![](img/59405528524733872b71504340c60ba4_109.png)

那我们因为在这儿绘制高斯，这咱们给了一个figure是吧，我们把它删掉啊，我们让高斯混合模型，汇到最右侧的这个这个子视图当中。



![](img/59405528524733872b71504340c60ba4_111.png)

所以把这行代码删掉，现在你来看这个效果图，现在你就发现，你看咱们使用高斯聚类得到的效果，是不是和我们原始数据这个是不是最像呀，看到了吧，像不像是不是哎，大家要注意啊，你这个类别是吧，用012表示。

那到底哪一类用哪个数字表示，这个是无关紧要的啊，好那么k means效果是吧，你看你想象一下，你只要能够离知道咱们k means这个算法，原理是怎么样，那么他得到的这个结果是这样的。

你就不会感到吃惊和意外了，对不对，而高斯混合模型，你就能够看到他得到的数据，和咱们原来的这个数据是最最吻合的，看到了吧，哎这就是高斯混合模型，这个算法咱们呢给举了一个这样的例子。



![](img/59405528524733872b71504340c60ba4_113.png)

我们举了一个这样的特征的数据。

![](img/59405528524733872b71504340c60ba4_115.png)

来为各位演示了一下，这样你就知道这不同的算法，不同的聚类，它呢适合不同的数据。

![](img/59405528524733872b71504340c60ba4_117.png)

对不对，这叫一物降一物，每一个算法呢对应着不同的数据。

![](img/59405528524733872b71504340c60ba4_119.png)

那以后呢你在进行聚类的时候，那你就得多使用几种算法进行综合对比，因为你以后接触的数据，你能知道这个数据长什么样吗，能知道这个数据内部结构是怎么样的吗，你不能知道是吧，很多时候你都不知道啊。

我们给的数据比较简单，咱们进行了可视化以后，你的数据有几十个属性，那是没有办法画出来的，对不对，哎所以说呢不同的算法我们都要掌握。



![](img/59405528524733872b71504340c60ba4_121.png)