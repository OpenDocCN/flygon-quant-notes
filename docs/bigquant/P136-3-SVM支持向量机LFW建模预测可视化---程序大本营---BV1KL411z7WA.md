# P136：3-SVM支持向量机LFW建模预测可视化 - 程序大本营 - BV1KL411z7WA

接下来咱们具体看一下，看我的花了五分钟，如果你执行我的代码，有可能你花的时间更长一些啊，好那么咱们就往下在下面这一行代码当中，咱们呢就使用gc点，咱们得到它best params，这个时候你看我一执行。

现在你能够发现看啊，咱们所筛选出来的，看最合适的，看最合适的参数是什么，看到了吧，最合适的参数是不是c是0。001，咱们的kernel是不是linear，咱们的这个tol是不是0。01，看到了吧。

费了多大的劲筛选出来的是吧，那既然我们筛选出来了，那么咱们就使用这个作为咱们这个模型，创建的条件，好不好，好，那么来这个筛选出了合适的参数，接下来呢我们再来一个三级标题好。

那么我们就使用最佳条件来进行建模，那这个时候呢就声明s vc就等于s v c，那我们给它相应的这个参数，第一个呢c就等于0。01，第二个呢咱们给一个kernel，kernel呢我们就给一个linear。

第三个呢就是咱们的tol，我们给一个0。01好，那么咱们这个数据咱们这个模型有了，接下来呢我们对于咱们的数据进行一个拆分，那就是train test split，那就是x下划线p c a然后逗号啊。

咱们的这个c少一个零，咱们现在呢再给一个零啊，好那么x是咱们降维之后的数据，y呢是咱们的目标值，然后接下来我们再给一个，咱们再将faces作为参数传进去，这个physis，你想它是不是人脸呀，对不对。

那这个faces和咱们的xp ca这是降维之后的数据，他俩是不是一一对应的呀，在这儿呢我们说这样的一句话来一个注释啊，看这个x p c a看嗯我们它是怎么来的，是不是x进行降维之后。

是不是就变成了pca啊，对不对，好，那么咱们的x和咱们的face他俩是什么关系呢，嗯那我们的他俩关系是不是都表示数据啊，看到了吗，他俩呢都表示数据，对不对呀，只不过一个是二维的，一个是三维的，对不对啊。

啊只不过呢数据形状是不是不一样呀，都表示数据他们的ship不同，但是数据一样，是不是这么个关系，所以你想一下咱们的faces和这个和这个xp ca，他俩是不是也能够进行对应上呀。

所以说咱们的faces啊和咱们的啊，faces和咱们的这个x p ca呢，它呢也是能对上的哈，咱们上面的是吧，它都是能对应上的啊，咱们来这样的标记是吧，所以说和咱们的x下划线pca是一一对应的。

那你要注意这个x下划线，pc这个是降维之后的，你看这是降维之后的数据，它呢不可显示，知道你想要画图画出来是吧，那这个不能画出来，所以咱们在进行拆分的时候看到了吧，我们在这进行拆分的时候。

咱们把faces也放进去了，为什么呀，我就是为了能够，咱们就是为了能够这个啊进行这个可视化啊，xp ca是吧，好来那么拆分一下，拆分一下，咱们那就是x下划线，pca下划线，春x下划线。

pc下划线test，然后y下划线tra，y下划线test，那么还有faces，那咱们就faces下划线train，然后faces下划线test，那我们在这个方法当中，咱们是给了三个数据，一分为二。

是不是就会分成这六个呀对吧，一一对应的啊，数据准备好了，咱们接下来就使用s v c点，我们就feat一下x下划线pca train，然后目标值外串放进去，训练完之后呢，咱们打印输出一下啊，print好。

那么这个就是训练数据，他的得分冒号，那么咱们就使用svc点，看咱们scr一个上面少了一个是吧，有少吗，没少啊，face train是吧，这少一个逗号啊，来咱们把这个逗号给他加上啊。

faces train，faces test是吧，y test y train好，那么咱们各位小伙伴的眼睛还是相当明亮的啊，来那说明你很有写代码的这个天赋啊，一般情况下就是我多写了或少写了。

这个都没关系，只要一执行代码，代码马上就会告诉你哪里错了，所以我嗯养成了这样的一个这个训练，出了这样的一个这个特征，只要这个代码报错了，我看一眼就能解决好，那么接下来呢我们看一下测试数据的得分是吧。

冒号，然后逗号同样调用svc，咱们调用sc，这个时候呢x下划线pca test放进去，然后y下划线test放进去，上面这个咱们修改一下，改成train，那此时我就执行这个代码了哈，咱们一运行哎。

来大家现在就能够看到，你看训练数据的得分是不是一点，咱们测试数据的得分是不是0。78呀，看到了吧，测试数据的得分是0。78，那这个这个说明呢大家看啊，咱们这个c是吧。

和这个这个kernel它的这个选择呢，大家还要继续调，知道吗，你还要继续调是吧，从而才能够选择合适的c是吧，呃那我这个之前呢，咱们这个模型就是支持向量机，这个模型一般呢使用这个r b f。

这个效果会好一些，咱们将这个tol是吧，这个容忍度我们给它增大一些，那我们再来看一下啊，选择了一个不同的核函数，你看这个时候咱们选r b f这个核函数，如果这个乘法项是0。01的话。

效果是不是就比较差呀，来咱们把这个乘法项给它调整成一，现在你来看是吧，这个时候是多少，0。95，0。74，是不是就快赶上上面这个了，那我们把c给它调大一些，调整成十，咱们再来看一下。

现在你就发现这个是不是，就变成0。788了呀，那我要是给它调整成50呢，咱们再来看一下啊，大家看基本上是不是就到上限了，来个150会怎么样，让他更加苛刻一些，诶你看是不是和上面就差不多了，对不对，哎。

所以说咱们通过grade search cv筛选出来这个参数呢，它是经得住考验的啊，好那么嗯我们呢再一次执行咱们上面的代码啊，看再一次执行上面的代码，那么我们就运行一下好。

那么大家看这回咱们的得分是多少啊，0。838哎，那这回这个得分为什么高了呀，因为咱们的train test split，它是是不是随机划分的呀，看到了吧，它呢是随机划分的哈，所以说呢有一定的随机性。

那这个分数呢就有一定的波动性好，那么咱们根据最佳条件进行建模了，然后呢我们再来一个三级标题，接下来咱们怎么样，我们呢就进行一个可视化啊，咱们进行可视化，我们就使用上面的svc嗯，如果要进行可视化的话。

我我们为了这个结果统一，咱们将上面这个代码我们先复制下来是吧，复制下来之后，咱们在这儿s vc点，我们调用一个方法叫predict，我们将x下划线，咱们将x下划线pca test放进去。

咱们这个时候是不是就会得到预测值呀，接收一下啊，上面进行一个说明，这个就是咱们算法的预测值啊，此时这个就是算法地域测值，那么我们可视化可视化，咱们就要可视化一下咱们的外这个外predict，执行一下。

看执行一下，我给你看一下啊。

![](img/470919ffd16d1187d318610a8eaa8dc8_1.png)

咱们画出来的图形大概是什么样的啊，你看一下这个数据可视化是吧。

![](img/470919ffd16d1187d318610a8eaa8dc8_3.png)

我们将这些人脸给它画出来，同时把他的名字给他写上。

![](img/470919ffd16d1187d318610a8eaa8dc8_5.png)

那么我们就操作一下吧，咱们就回到代码当中，咱们这个测试数据呢是比较多的，我们画不了那么多，咱们就给他画25个吧，咱们就来一个五行五列的怎么样，或者说咱们来一个十行五列的。

那就来一个for循环叫for i in range，咱们就来一个50，看到了吗，好那么这个接下来呢咱们就开始画图，那既然是十行五列，这个时候就得添加子视图，咱们就调用sub plot是吧。

十行五列第几个呀，第egg这个i是从零开始的，所以我们给它加个一看，这个时候呢我们就有了一个子视图，有了子视图，咱们就像子视图当中进行绘制图片，那就是1米指受，那我们我们在进行绘制图片的时候。

咱们的算法预测的是不是咱们xp ca test，对不对，xp ca test它能画图片吗，它能可视化吗，它是不是不能显示呀，这个数据是降过维的，那我们在进行数据拆分的时候，你看我们专门留了一手。

这个里边是不是给了三个呀，你看为啥我要把physis放进去，它可以画图画出来进行展示对吧，那么在进行拆分的时候，他们的规则是一样的，这个时候咱们的face faces test和咱们的x下划线。

pca test他俩是一一对应的，看他俩呢是一一对应的，你知道为什么吗，上面咱们是不是进行了说明呀，x和x p c a是一一对应的，因为这个是降维之后的数据呀，x和咱们的faces这个都表示数据。

它俩只是形状不一样，但是数据一样，那所以咱们的faces和这个x p ca，是不是就是一一对应的呀对吧，他和这个x p ca就是一一对应的，那他俩如果是一一对应的啊，就这两个如果是一对应的。

咱们在进行数据拆分的时候，你想一下我们把这个数据拆分成两份，那拆分成两份，这个x test xp ca train和咱们的face train，这俩是不是也是一一对应呀对吧。

那x p c a test和fes test，这也是一一对应的，既然是一一对应，我们对于咱们的xp c test进行了预测，那么我们想要画图的话，咱们是不是就是画faces test，从这个当中取数据。

是不是就可以了，所以说呢咱们就pro t一米指受，我们呢就将faces test放进去，中国号，咱们就来一个i，那么这个时候呢你看啊我执行一下，看看能不能画出来啊，你看我一运行，大家看画出来了，太小了。

是不是啊，为啥呀，我们没有调整尺寸，那咱们就需要在for循环之外调一下它的尺寸，那就是p t怎么调尺寸，是不是通过figure方法呀，里边有一个参数叫figure size，那我们就调一下吧。

咱们说在调尺寸的时候，这第一个参数咱们是给的宽度，宽度是由什么来决定的呀，宽度是不是由列呀，我们一共有几列五列，我们让每一列的宽度是二，所以说就是5x2，接下来第二个第一宽度有了，第二个就是高度。

高度是不是就有行决定我们有几行呀，我们有十行，我们打算让一行的高度是多多高呢，我们打算让它的高度是三，所以这个时候咱们就来一个三，为啥是三呢，我们还需要往这张图片的上面是吧，给他写上名字。

因为咱们的人脸呢，它是高度要比宽度是不是要长呀，好那么我们在显示这个图片的时候呢，咱们给他一个c map，我们让它是葛瑞，同时咱们这个图片在进行这个绘制的时候，把它的刻度怎么样呀，给他关闭掉。

你看不然的话这会有一个100 100是吧，我们plt axis这个的话我们可以将刻度关闭，那此时我再来执行。



![](img/470919ffd16d1187d318610a8eaa8dc8_7.png)

诶，现在你来看是不是就舒服多了呀，看到了吧，这就是我们的这些人脸。

![](img/470919ffd16d1187d318610a8eaa8dc8_9.png)

好，所以说呢你需要就我们这个代码是很简单的啊，不太难，那么你需要干嘛呀，你需要掌握它的规律是吧，我们sub plot也好，其实你看本质上来说是不是就是一个for循环呀，你也可以知道吗，你也可以。

你下回不要为我鼓掌了啊。

![](img/470919ffd16d1187d318610a8eaa8dc8_11.png)

下回呢你为自己鼓掌好不好，来，那么这个人到底是谁呀。

![](img/470919ffd16d1187d318610a8eaa8dc8_13.png)

对不对，这个人到底是谁，我们把他的名字给他写上去好不好，那我们plt咱们之前在讲啊，咱们之前在讲那个画图的时候，我们说这个画图呢，它有一个函数和方法叫做prt。title。

这个title是不是就是给他这个写名字呀，来咱们就写一个名字，写名字，我们来一个true，true呢，就表示真实名字，你这个名字是谁，2%s给他占个位置，然后反斜杠n反斜杠n就表示换行。

然后咱们接下来再来一个predict，predict就是预测预测的这个名字是谁呢，也来一个2%s，那么我们字符串的这个格式化，就是通过这种形式来给定的，里边有两个百分号，两个百分号就表示占位符是吧。

那么然后再来一个百分号是吧，百分号小括号里边就给我们的数据了，那我们就给数据吧，第一个是真实的是吧，咱们就来一个t啊，第二个是预测的，咱们就来一个p是吧，好那么我们给它起一个啊，叫t name。

后面这个叫p name，这就是算法预测的好，那么he name，看你就是说你的这个真实的名字是吧，真实的名字，要不咱们写上吧，就true name。

第二个叫predict p r e predict name，那你这两个字符串是不是还没有呀，对不对，这两个字符串还没有，那我们如何获取呢，就是true name等于多少呀。

你的这个predict name等于多少呀，是不是咱们的true就是真实的名字，也就是说你face test这张人脸对应的名字是谁，我们上面是不是有一个测试数据的保留值，它是不是叫做y test。

why test里面是不是就是咱们真实数据，对不对，你看这个y test当中，就是我们的真实数据的目标值，但是它的数据呢是01231直到六，那我们这个我们这个数据库当中是吧，有有很多人啊。

这个数据库当中有很多人脸，只不过我们在加载人脸的时候，咱们给了一个限制，我们加在人脸的时候，咱们是这样，就是说你的这个人脸，每个人的人脸，你的数据得超过70个，我才会获取这个图片，好。

那么这个时候呢咱们介绍了这个y test，就是它的真实值是吧，因为这个你看这个y test，看你看咱们的y test，y test和咱们的x下划线pca，你看他俩是不是对应的。

我们在进行测试数据得分的时候，咱们是不是也把他俩成对的放进去啊，所以他俩是一一对应的啊，你看它俩是一一对应的，它是数据y test就表示真实它的类别，那么这个真实类别是多少呀，来咱们获取一下呗。

那不就是通过y下划线test吗，咱们把i放进去是不是就可以了，看到了吧，我们把i放进去啊，因为这个i是不是咱们的索引啊，咱们是不是就是获取了face test当中前50个呀，你获取了前50个。

你的y test和它一一对应，咱们是不是获取y就行了对吧，然后咱predict也一样，predict是谁，是y predict嗯，上面你看我是不是进行了算法训练之后，我是不是紧接着就对它进行了预测呀。

看y predict这个就是咱们预测的值，预测值呢咱们也得一下，得到之后你要注意啊，这个是什么呀，他们呢得到之后呢，他们呢是这个数字，你看我执行一下，给你看一下。



![](img/470919ffd16d1187d318610a8eaa8dc8_15.png)

你看predict 3，predict 4是吧，你能够发现这个是不是就是咱们的数字呀。

![](img/470919ffd16d1187d318610a8eaa8dc8_17.png)

那咱们怎么才怎么才能把它转换成名字呀，啊咱们这样转换成名字，调用targets，看来一个中括号是吧，下面也一样，你看targets来一个中括号，唉你看这个时候我一执行唉。



![](img/470919ffd16d1187d318610a8eaa8dc8_19.png)

你现在就能够看到名字是不是就有了呀，但是这个时候我们发现这个名字呢，就挤成一团了。

![](img/470919ffd16d1187d318610a8eaa8dc8_21.png)

对不对，看名字挤成一团了，这样看起来也不好看。

![](img/470919ffd16d1187d318610a8eaa8dc8_23.png)

你想你在喊美国总统的时候，你是不是就直接把它叫做布什呀。

![](img/470919ffd16d1187d318610a8eaa8dc8_25.png)

那外国人的名字是不是都看他最后这个字啊，对吧，最后这个这个叫法。

![](img/470919ffd16d1187d318610a8eaa8dc8_27.png)

那咱们怎么办，外国人的名字有一个特点是吧，last name是吧，他们明他们这个姓和名之间也也会有空格，咱们怎么样，split是吧，根据什么来划分，根据空格，然后中括号来个-1。

这个是不是就表示最后点supercli看啊，你在听新闻的时候是吧。

![](img/470919ffd16d1187d318610a8eaa8dc8_29.png)

这个都是如此啊，来个-1-1，就表示最后这个时候你看我再来执行。

![](img/470919ffd16d1187d318610a8eaa8dc8_31.png)

唉现在你就能够看到看结果是不是出来了，看到了吗，第一个是不是布时预测出来了吧，第二个是不是给预测错了，不实这个嗯。



![](img/470919ffd16d1187d318610a8eaa8dc8_33.png)

布莱尔是吧，这个预测错了啊，你看我们的准确率大概是多少。

![](img/470919ffd16d1187d318610a8eaa8dc8_35.png)

是不是80多，你再往下看是吧，再往下看准确率八八个80多。

![](img/470919ffd16d1187d318610a8eaa8dc8_37.png)

那也就是十个当中是吧，可能会有两个给预测错看。

![](img/470919ffd16d1187d318610a8eaa8dc8_39.png)

再往下看嗯，这些是不是都顺眼一些了，看到了这一排全正确是吧，这一行呢是不是也全正确。

![](img/470919ffd16d1187d318610a8eaa8dc8_41.png)

看到了吗，这一行全正确，这一行全正确。

![](img/470919ffd16d1187d318610a8eaa8dc8_43.png)

这一行是不是也全正确，这一行呢也哎这这有一个错的。

![](img/470919ffd16d1187d318610a8eaa8dc8_45.png)

看到了吧，这有一个错的啊，这一行呢哎这有一个错的，是不是啊。

![](img/470919ffd16d1187d318610a8eaa8dc8_47.png)

这也有错的，唉，你看这个就是我们使用支持向量机，咱们进行了建模，你能够看到啊，嗯大家跟着我一起学，到这里你就能够发现，这个算法是不是还挺强大的呀，对于这些图片。



![](img/470919ffd16d1187d318610a8eaa8dc8_49.png)

我们经过了数据处理之后，看咱们经过了降维运算之后，咱们是不是就可以，你看预测出来这张图片到底是谁，嗯是吧，你看通过降维运算之后，我们就我们就能够知道是吧，这张图片是谁，另一张图片是谁。

你想一下我们人类是目前这个世界上是吧，智能最高的生物了，为什么我们这么多年学习学下来，我们能够识别各种各样的东西呢是吧，是不是因为我们大脑的训练，你之前肯定也听说过狼孩的故事是吧，刚出生的小孩儿是吧。

被狼给收养了，那么他长大之后，他的所有生活习惯，他的思考方式是不是都是狼的方式呀对吧，他就不能再进行交流是吧，不能够融入我们人类这个世界了，人类这个社会了，那算法也一样，看算法也一样。

它呢你只要给他合适的数学公式，他也会进行训练，也会进行特征的提取是吧，知道这个嗯，你比如说是吧，这个新东方好未来是吧，还有这些教育类公司，从7月24号到现在是吧，基本上都一直在跌跌不休，一直在跌停状态。

为什么呀，国家发布了新的政策，新的政策就不允许周六周日不允许放假，不允许放假的时候给学生补课，那你想他们主要的收入，是不是都是在这个上学之后呀是吧，学校上完之后，那所以说他们这个生意就不好做了。

所以我们人类就很敏感是吧，我们经学经济的也好，或者说我们即使不炒股，咱们也知道，对于他们是不是就是一个利空呀对吧，那所以说这个股价唰唰的就降低了，新东方有原来的这个二三百亿，一下子跌到现在的是吧。

90%都跌。

![](img/470919ffd16d1187d318610a8eaa8dc8_51.png)

跌没了，只剩这个二三十亿了，你想那这就是人是吧。

![](img/470919ffd16d1187d318610a8eaa8dc8_53.png)

总结的规律特征算法也一样是吧。

![](img/470919ffd16d1187d318610a8eaa8dc8_55.png)

咱们支持计算机，那我们对数据进行处理之后，咱们呢这个使用网格交叉，我们选择了合适的一个使用网格交叉，咱们选择了合适的参数，然后呢我们使用最佳的条件建模，最后呢我们进行预测。



![](img/470919ffd16d1187d318610a8eaa8dc8_57.png)

最后呢咱们进行可视化嗯。

![](img/470919ffd16d1187d318610a8eaa8dc8_59.png)