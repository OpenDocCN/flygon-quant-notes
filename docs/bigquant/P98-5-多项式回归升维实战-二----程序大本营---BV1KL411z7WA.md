# P98：5-多项式回归升维实战（二） - 程序大本营 - BV1KL411z7WA

那我们继续往下看啊。

![](img/622ea3d283652e712f90ad26b25fccac_1.png)

呃咱们再来看多项式回归，那我们再来一个这个实战啊，那此处的这个实战呢，咱们要介绍一下，咱们要介绍一个包，那咱们导一下包啊，咱们from sk learn，同样呢linear model当中。

咱们导入linear regression from sklearn preprocessing，这个是数据预处理，咱们从数据预处理当中导入polynominal feature。

然后呢逗号咱们再将这个标准化归一化，我们给它导进来，然后再导入import number as np。



![](img/622ea3d283652e712f90ad26b25fccac_3.png)

好，那么在这个里边呢，我们着重介绍一下，咱们先导的这个包叫polly nominal feature，你知道它的作用是什么吗，嗯这个呢就是升为什么叫polly呢，这个polly就有多项式的意思。

看polly就有多项式的意思。

![](img/622ea3d283652e712f90ad26b25fccac_5.png)

上面咱们对于数据进行升维，咱们是不是自己进行了一个计算呀，是不是你看np。cocculate x逗号x的平方。



![](img/622ea3d283652e712f90ad26b25fccac_7.png)

是不是，那么这个操作呢咱们可以交给polly。

![](img/622ea3d283652e712f90ad26b25fccac_9.png)

nominal feature来完成好，那么此时呢咱们依然去创建一个数据啊，那么我们此时创建的数据，和咱们刚才那个数据一样。



![](img/622ea3d283652e712f90ad26b25fccac_11.png)

所以说这个时候呢咱们把上面创建数据的操作。

![](img/622ea3d283652e712f90ad26b25fccac_13.png)

咱们直接复制一下，好不好，ctrl c啊。

![](img/622ea3d283652e712f90ad26b25fccac_15.png)

直接复制一下，粘贴过来，ctrl v唉，这个就是创建数据了，依然是这个数据，那有了这个数据之后，咱们接下来呢我们就操作一下。



![](img/622ea3d283652e712f90ad26b25fccac_17.png)

那有了这个数据了，那我们还有咱们的测试数据，没有给咱们也给一个test，那咱们的x test就等于np点，line in space，咱们从-二到正的12，我们依然给它分成300份。

咱们来一个resh-1和一，这个时候形状就改变了，这个时候你发现x test它的形状就是二维的。

![](img/622ea3d283652e712f90ad26b25fccac_19.png)

看到了就是300和一，注意啊，我们说的是形状是二维。

![](img/622ea3d283652e712f90ad26b25fccac_21.png)

但是它的特征是一个是一维好，那么接下来呢咱们就使用polly nominal feature，我们给它进行一个升维，好不好，好。

那p o l y声明polly polly nominal feature。

![](img/622ea3d283652e712f90ad26b25fccac_23.png)

这个里边你看默认情况下给了一个什么，是不是degree，这个degree就表示二次幂，如果你要把它变成三，那么它就是三次幂，知道吗，那么它就是三次幂，这里边有一个参数叫tract only。

嗯那这个intertract only，它是看它是什么意思啊，嗯这就是这个内机，你看intertract ri这个参数就是内积，这个默认情况下它是false，如果是true的话。

叫only interaction features are predict啊，这个predict。

![](img/622ea3d283652e712f90ad26b25fccac_25.png)

那我给你解释一下这个参数是什么意思啊，intertract only，咱们首先来一个true，好不好，那我为了给你演示，咱们给一个大a啊，咱们让a这个数据是多少呢，比如说咱们来一个中括号。

我们来一个一和三。

![](img/622ea3d283652e712f90ad26b25fccac_27.png)

看到了吧，这个数据是一和三，然后呢咱们就调用polly点，那我们就feat transform一下。

![](img/622ea3d283652e712f90ad26b25fccac_29.png)

咱们将a放进去，这个时候你看我一执行，你看这个时候我一执行，咱们得到的结果是多少，看到了吧，是不是113和三呀，看到了吧，你看它是113和三哎，那这个是你看得到的结果是1133，那这个是怎么回事啊。

看到了吧，这个是怎么回事呢，那我们现在呢把interact only这个参数，我们给它改成false啊，对比一下，上面是true，下面呢复制一下这个代码，咱们粘贴一下，把这个参数我们给它改成false。



![](img/622ea3d283652e712f90ad26b25fccac_31.png)

这个时候你就能够看到，你看我如果要是false，看如果要是false，这个时候你会发现咱们得到的结果是，看咱们得到的结果是什么，看到了吧，是不是113139诶，那这个113139这个作何解释呢。

看到了吧，上面咱们是不是没有自己和自己相乘呀，这intertract early呢啊，tract ri，它呢就是特征和特征啊，这就是特征和特征来进行操作，来进行相乘，特征之间啊，这叫特征之间。

有可能咱们举的这个例子有点多，咱们就给一个三啊，你来看啊，执行，你看咱们给了一个三，你会发现咱们得到的数据是一三，是不是，现在我给你解释为什么啊，嗯我们对于三进行了一个什么呀，零次幂看到了吧。

我们对三进行了一个零次幂，然后呢我们又对三进行了一个什么一次幂，那我们又对三进行了一个一次幂，所以说咱们得到的结果就是一和三，下面这个呢看如果要是false呢，你看我们已执行，咱们得到的结果就是什么。

看到了吧，是不是就是139呀，那我们来了一个，咱们来了一个139，那这个你看这个它是怎么计算出来的，它是不是就是三的星号，星号是不是给了个零次幂，然后三星号星号是不是给了个一次幂。

然后继续三星号星号是不是给了个二次幂啊，对不对，看到了吧，那同样如果说我要多给几个数呢，你比如说逗号啊，看逗号，比如说我再给个二，你看一直行，这也是一样的，看这也是一样的。

上面咱们这个得到的结果怎么是1326呢，看了上面咱们得到的结果为什么是1326，这个时候我给你解释一下，你看三的零次幂，三的一次幂是不是一和三呀，对不对，看到了吧，然后呢，那为什么会得到二啊。

是不是二的零次幂，对不对，是不是二的零次幂，然后为什么会得到六呢，看到了吧，逗号啊，咱们这儿呢来了一个二的零次幂，后面呢为什么会得到六，它是2x3，看到了吧，二和三是可以相乘的。

所以说他就会得到1326，为什么，你看咱们这个tract false，看嗯对二的零次幂是一啊，咱们二的零次幂是一啊，那这个时候哦说错了，应该是二的一次幂，看应该是二的一次幂啊，因为啥呀。

因为咱们得到的这个结果，你看三的零次幂和二的零次幂是不是都是一呀，啊，三的零次幂和二的零次幂都是一，所以说只要有一个一就行了啊，所以只要有一个一就行了，所以说呢咱们是三的零次幂，二的零次幂。

他俩呢进行了一个合并啊，三的零次幂，还有咱们二的零次幂，他们俩进行了一个合并，然后三的一次幂，二的一次幂，然后呢2x3，这就是咱们特征之间进行相乘。



![](img/622ea3d283652e712f90ad26b25fccac_33.png)

那下面这个呢看咱们逗号，如果我也给一个二，你看这个时候一执行咱们得到的结果是什么，是不是三的零次幂或二的零次幂呀，三的一次幂，对不对呀，然后这个二的一次幂，然后呢2x3，然后三的二次幂是不是。

然后二的二次幂啊，所以说这个false它不仅是特征之间相乘，而且是特征和特征自成，是不是啊，看这个叫false，它求解出来的结果就更加广泛，这个呢是特征之间进行乘法，并且啊并且呢他是自己啊。

并且是自己和自己再进行运算啊。

![](img/622ea3d283652e712f90ad26b25fccac_35.png)

并且自己和自己进行这个逆运算，所以说通过这个。

![](img/622ea3d283652e712f90ad26b25fccac_37.png)

那为什么不继续进行成，因为默认情况下，咱们里边有一个参数叫degree，degree，degree，默认情况下是二，你可以调整这个二，比如说我把这个二调整成四，现在你就能够发现来乐高小伙伴。

你就能够发现，你看调整成四，二的四次幂口算出来是不是就是16呀，三的四次幂口算出来是不是就是81呀，看到了吧，哎现在明白了吧，所以说你可以通过这个来调整来给他升高啊。



![](img/622ea3d283652e712f90ad26b25fccac_39.png)

所以呢咱们sk learn就为我们提供了一个方法。

![](img/622ea3d283652e712f90ad26b25fccac_41.png)

这个方法就可以帮助我们进行数据的升维，升维之后你要观察它的规律啊。

![](img/622ea3d283652e712f90ad26b25fccac_43.png)

知道吗，升维之后要观察它的规律好。

![](img/622ea3d283652e712f90ad26b25fccac_45.png)

那么其实呢其实你想咱们的这个三的一次幂，你看它相当于什么啊，我来告诉你，咱们写一个markdown，这个时候他更能够详细清楚的来表示出来，你看我们上面是三和二，其实呢它是三嗯这个一次幂啊，然后呢乘以二。

它的这个乘以二，它的一次幂，看这个时候那就是三的一次幂乘以二的一次幂，这个结果是不是就是六呀，对不对，你看这个结果就是咱们这个结果，那就是六，是不是，那所以说呢这个结果呢他呢就等于六，好。

那你比如说咱们还有一个这个三星号，一次米是吧，那它可以写成什么呢，那就是dollar dollar，那我们就是三星号一次幂乘以二嗯，这个零次幂，那么它的结果你看二的零次幂和三的一次幂。

这个结果你想是不是就是三啊啊，三的一次幂，二的零次幂是不是因为上边是interact等于false，它在进行操作的时候，是只能特征和特征之间进行相乘，所以说你三它的右上角就不能带一个二。

而下面这种方式是可以的，好那么这个方法咱们介绍好之后呢。

![](img/622ea3d283652e712f90ad26b25fccac_47.png)

那我们就使用这个polly nominal feature，咱们呢对这个数据呢我们来进行相应的操作好，那这个时候呢咱们就polly嗯，就等于polly nominal features。

那默认情况下这个degree咱们就给一个二吧，好不好，默认情况下我们就给一个d，那参数呢咱们也使用它默认的啊，那咱们就pol。feat transform。



![](img/622ea3d283652e712f90ad26b25fccac_49.png)

咱们将数据给它放进去，上面的数据咱们是不是已经调整好了。

![](img/622ea3d283652e712f90ad26b25fccac_51.png)

是不是叫做x，那咱们就把x放进去，这个时候x放进去转换之后得到的结果，咱们起个名字叫x2 啊，看这个时候咱们查看一下x2 的形状，这个时候你就发现它的形状呢就更多一些。



![](img/622ea3d283652e712f90ad26b25fccac_53.png)

看到了吗，它是不是100和三呀，这个时候你想，它是不是就变成三维的一个数据了，好那么变成了三维的数据之后呢。



![](img/622ea3d283652e712f90ad26b25fccac_55.png)

来这个时候呢，咱们就使用线性回归来对它进行一个预测吧，那就是model就等于linear regression，然后咱们就使用model点，咱们就feat一下，把x2 放进去，目标值y放进去。

上面咱们对于训练数据进行了一个转换，那么测试数据也一样，咱们的测试数据叫x test，就等于polly点，那在这儿呢咱们同样也调用fit transform，把测试数据也放进去，转换之后。

这个测试数据就叫x test 2，执行一下这个代码来运行数据转换成功，那model进行了训练，然后呢我们就进行predict，咱们就将x下划线test 2放进去，它会得到一个预测值。

咱们起个名叫y predict，这个时候呢咱们画图画出来，我们就知道效果怎么样了，那prt。scanner，咱们先将原数据绘制一下，那就是xy，然后plt点画出来这个图形plot。

那咱们的嗯测试数据是x test，目标值就是咱们预测出来的predict。

![](img/622ea3d283652e712f90ad26b25fccac_57.png)

这个时候你看我一直行，唉，大家发现是不是也能够很好地进行一个嗯，吻合呀，看到了吧，是不是很好。

![](img/622ea3d283652e712f90ad26b25fccac_59.png)

看到了吧，唉这个是很好的啊，所以说呢在咱们多项式升为实战二当中，我们呢就为各位介绍了polly nominal feature，它的一个使用好，那么在这里我们如果要将这个degree变成三维。

我们看一下会怎么样啊。

![](img/622ea3d283652e712f90ad26b25fccac_61.png)

来各位你看啊，此时我把它调整成三维了执行。

![](img/622ea3d283652e712f90ad26b25fccac_63.png)

然后我们再执行，唉大家现在看三维是不是也能够很好的拟合呀。

![](img/622ea3d283652e712f90ad26b25fccac_65.png)

看到了吗，那为何，那如果我要调整成五维呢。

![](img/622ea3d283652e712f90ad26b25fccac_67.png)

来试一下执行是吧，然后咱们运行一下。

![](img/622ea3d283652e712f90ad26b25fccac_69.png)

你看五维是不是也能够很好地拟合呀。

![](img/622ea3d283652e712f90ad26b25fccac_71.png)

哎难道高维都能很好的拟合吗，咱们看一下扣一。

![](img/622ea3d283652e712f90ad26b25fccac_73.png)

现在你就能够看到看到了吧，看这个是这个是呃，这个是零维，这个是一维，这个是二维，三维四维，这个是五维，各位小伙伴，你能够发现嗯，你看后面的高维，我们所得到的系数是不是非常非常小呀，看到了吧。

高维咱们所得到的系数非常非常小啊。

![](img/622ea3d283652e712f90ad26b25fccac_75.png)

实际当然也有这么好的这个数据了。

![](img/622ea3d283652e712f90ad26b25fccac_77.png)

你看看到了吧，0。007，就是因为咱们的线性回归拟合出来规律，他就发现后面的高维，对于咱们的结果影响不是特别好，所以你看它是不是，就把咱们的系数变得特别特别小呀，如果这个系数特别特别小。

看如果这个系数特别特别小，你想一下他是不是就不重要呀，嗯对不对，你看系数小，系数的绝对值小啊，咱们系数的绝对值小，那就说明咱们这个不重要，对不对，是不是好，你想大家看。

咱们现在有小伙伴说为什么会有负数呀，你想这个方程开口是向哪的，这个方程开口是不是向上的呀，那当然会有负数了。



![](img/622ea3d283652e712f90ad26b25fccac_79.png)

对不对，来我给你看一下，看一下咱们所创建的这个方程啊。

![](img/622ea3d283652e712f90ad26b25fccac_81.png)

看是不是x减五的平方加上3x减12啊，对不对，如果你要我如果我们要把这个方程展开的话，你想一下是不是就是x的平方减去10x加3x，你减10x加3x是不是就相当于它减去7x，对不对，减去7x所以会怎么样。

看来现在的话。

![](img/622ea3d283652e712f90ad26b25fccac_83.png)

咱们可以把这个方程展开，给各位小伙伴看一下啊，咱们把它写成mark down，那这个时候是不是就是dollar dollar呀，你看把这个方程写开，是不是就是x的平方，然后加上这个时候应该是减去了。

你五和x相乘是-10 x，对不对啊，后面有一个sx，那sx是不是就是减去7x呀，对不对，那就是减去7x，然后那这个五五是25，25-12是不是等于13呀，是不是等于加上13。

咱们这个方程你看是不是应该是这样一个方程。

![](img/622ea3d283652e712f90ad26b25fccac_85.png)

所以你看你这个系数是不是-7，那我们求解出来的是不是这个是负的，6。718是不是和它分成。

![](img/622ea3d283652e712f90ad26b25fccac_87.png)

是不是和这个标准答案非常吻合呀，而我们的标准答案咱们是加了一定噪声的。

![](img/622ea3d283652e712f90ad26b25fccac_89.png)

对不对，你看到了吧，加了一定噪声的，所以说咱们求解出来的这个数据呢。

![](img/622ea3d283652e712f90ad26b25fccac_91.png)

稍微有点波动，大家要注意啊。

![](img/622ea3d283652e712f90ad26b25fccac_93.png)

咱们现在所给的数据是比较简单的，所以我们给二维也好，咱们给五维也好，咱们都有一个比较好的一个答案。

![](img/622ea3d283652e712f90ad26b25fccac_95.png)

那根据奥卡姆剃刀原则。

![](img/622ea3d283652e712f90ad26b25fccac_97.png)

咱们是不是能简单就不复杂呀，如果咱们一维可以搞定，那咱们就不要升维了，如果二维能够搞定。

![](img/622ea3d283652e712f90ad26b25fccac_99.png)

咱们还有必要去升三维吗，是不是就没有必要升三维呀。

![](img/622ea3d283652e712f90ad26b25fccac_101.png)

对不对，所以说呢咱们二维我们把它拟合出来了。

![](img/622ea3d283652e712f90ad26b25fccac_103.png)

那么咱们就使用二维就可以了，唉大家明白了吗。

![](img/622ea3d283652e712f90ad26b25fccac_105.png)

根据奥卡姆剃刀原则，能简单不要复杂，这是咱们升维的一个原则，各位小伙伴听明白的，咱们在讨论区扣一个666是吧，poly nominal feature，这个方法掌握了。



![](img/622ea3d283652e712f90ad26b25fccac_107.png)

知道他是怎么回事是吧。