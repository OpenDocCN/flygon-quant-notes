# P65：8-梯度下降可视化 - 程序大本营 - BV1KL411z7WA

![](img/35cc1e9dc02965cd00cdb1de63891075_0.png)

看来咱们最后啊，我们把它画出来好不好。

![](img/35cc1e9dc02965cd00cdb1de63891075_2.png)

我们把这个他的整个学习过程。

![](img/35cc1e9dc02965cd00cdb1de63891075_4.png)

这每一步到底怎么走的，咱把它画出来好，那么我们在循环之前是吧，咱们给一个数据，这个数据就叫x盖，咱们给一个列表，这个列表当中存的数据呀，就是我们每一步计算更新之后，你这个x是多少，一开始的时候。

这个x是不是随机给的，咱们就把这个数据给它放进去啊，看一开始因为这个数据是随机给的，在这儿呢咱们做一个说明，这个x杠是什么，这个x杠呢就是咱们每次啊，就是每次梯度下降是吧。

咱们所求解出来的x值一开始是随机给的。

![](img/35cc1e9dc02965cd00cdb1de63891075_6.png)

对不对啊，一开始是随机给的，那咱们就在while true循环当中，只要进行了更新，看这个地方是不是更新，咱们就怎么样，x杠点append end，我们是不是把新的数据给他追加进去啊，看到了吧。

这个时候追加进去，此时呢咱们也就不用打印更新，这个数据更新是多少了是吧，咱把这行代码给它注掉，在这儿呢我们来一个count，count呢就是计数看一下咱们for循环执行了多少次，好不好。

看一下for循环执行了多少次好，那么只要更新一次，咱们的count就怎么样呀，加等一，当这个while循环结束，那我们就print输出一下是吧，在这儿呢咱们就来一个这个加号加号加号，那我们就写一个文本。

这个呢就是梯度下降的次数，冒号多少呢，唉我们把count放到这上面。

![](img/35cc1e9dc02965cd00cdb1de63891075_8.png)

有了数据了，对不对，就是x杠，现在咱们是不是就可以画图，把它画出来了，好那么我们在进行画图的时候呢，咱们给一个范围嗯。



![](img/35cc1e9dc02965cd00cdb1de63891075_10.png)

那在这个地方呢，嗯大家看啊，咱们给给一个范围啊。

![](img/35cc1e9dc02965cd00cdb1de63891075_12.png)

因为上面咱们给定的数据是x是不是，那这个呢咱们就给一个x1 ，就等于np一点lspace啊，line space，咱们依然让他从零到11。5吧，然后我们把它分成100份，这个时候呢我们给一个y1 。

你看这个时候呢就是函数是不是f呀，咱把x一放进去，这时候你看我一画图x1 y1 ，你想这条线是不是就可以绘制出来，然后接下来呢咱们p o t。scanner，咱们绘制谁。



![](img/35cc1e9dc02965cd00cdb1de63891075_14.png)

咱们就绘制绘制每次梯度下降，它求解出来的x的这个值，哎这叫散点图，但是在绘制散点图的时候呢。

![](img/35cc1e9dc02965cd00cdb1de63891075_16.png)

你看啊，那我既然要把这个点画到咱们这个图形当中，大家想横坐标是不是就是x杠，纵坐标是不是依然要去根据函数关系，去计算一下它的纵坐标呀，这儿呢我给一个颜色，我让color等于red。

然后的话我给一个size，咱们让这个size等于30，这个时候你看我一执行代码，它会报错，看大家注意啊，这个时候咱们绘制的是散点图，看这个时候绘制的散点图，横坐标是不是就是咱们的这个计算。



![](img/35cc1e9dc02965cd00cdb1de63891075_18.png)

每一步梯度下降计算出来的这个x值呀，那纵坐标y是谁，y是不是就是咱们所对应的方程的那个点呀，你看f杠fx杠能不能执行出来，你看我一直行啊。



![](img/35cc1e9dc02965cd00cdb1de63891075_20.png)

一直行，大家看报错了，是不是哎为啥报错了。

![](img/35cc1e9dc02965cd00cdb1de63891075_22.png)

报哪一行错了，是不是报咱们的这个36行，这我们是不是少一个plot呀，哎在这儿咱们调用plot啊。

![](img/35cc1e9dc02965cd00cdb1de63891075_24.png)

好执行一下，唉现在你看这个图形画出来了，对不对，但是看但是我们报的哪一行错。

![](img/35cc1e9dc02965cd00cdb1de63891075_26.png)

报的是39行，你看到了吧。

![](img/35cc1e9dc02965cd00cdb1de63891075_28.png)

报的是39行，这跟我们说什么，看到了吧，你就是你在进行这个计算的时候。

![](img/35cc1e9dc02965cd00cdb1de63891075_30.png)

没法进行计算，因为它是一个list，我们创建x杠的时候。

![](img/35cc1e9dc02965cd00cdb1de63891075_32.png)

你看它是不是一个list，对不对。

![](img/35cc1e9dc02965cd00cdb1de63891075_34.png)

也就是说我们在执行f，看咱们在执行这个函数的时候。

![](img/35cc1e9dc02965cd00cdb1de63891075_36.png)

你看fx杠你只要一执行他就报错，看到了吧，但是我执行谁没事呢，我执行x一没事。

![](img/35cc1e9dc02965cd00cdb1de63891075_38.png)

你看一执行算出来了，为啥你看这个x一是什么，x是x1 ，那说明一下咱们的x一呢是不是咱们np数组呀，对吧，你看这个x一呢，它是np数组，而咱们的x杠是什么。



![](img/35cc1e9dc02965cd00cdb1de63891075_40.png)

x杠它就是咱们python中的列表，看他就是python中的列表。

![](img/35cc1e9dc02965cd00cdb1de63891075_42.png)

所以它不支持这个运算，那怎么办，咱们在画散点图之前对它进行一个转化，就是x杠就等于np。array小括号，咱们将x杠放进去，轻轻的一转换就可以了。



![](img/35cc1e9dc02965cd00cdb1de63891075_44.png)

这个时候你看我在执行，嗯这个时候我再看一下啊，依然给报错了是吧，哎大家看看这回报错是咱们的size报错。



![](img/35cc1e9dc02965cd00cdb1de63891075_46.png)

看这回报错，你看size报错是吧。

![](img/35cc1e9dc02965cd00cdb1de63891075_48.png)

为啥因为他没有这个参数，那如果没有这个参数，那么它就是s来执行一下。

![](img/35cc1e9dc02965cd00cdb1de63891075_50.png)

大家看出来了吗，看看是不是出来了，看我再执行一下啊。

![](img/35cc1e9dc02965cd00cdb1de63891075_52.png)

哎你看我一运行是不是又出来了，看到了吧。

![](img/35cc1e9dc02965cd00cdb1de63891075_54.png)

好那么这是我们的这个步幅，咱们这个步幅呢我把它调小一点。

![](img/35cc1e9dc02965cd00cdb1de63891075_56.png)

调成0。2，给给各位看一下啊，看到了吧，你看这个到底是怎么一步一步趋近的。

![](img/35cc1e9dc02965cd00cdb1de63891075_58.png)

一开始的时候给的这个值是这个是吧，看到了第一步迈的是不是特别大，为什么这第一步迈得特别大，是不是因为导数呀，因为导数大，是不是导数值大。



![](img/35cc1e9dc02965cd00cdb1de63891075_60.png)

所以说卖的特别大，然后他就一步一步一步，是不是趋近呀，咱们将这个图形我们给它尺寸调整一下啊，看我们将这个图形的尺寸调整一下，咱们呢在画图之前调用plt。figure。

f i g u r e在这个当中给一个figure size。

![](img/35cc1e9dc02965cd00cdb1de63891075_62.png)

12和九，这个时候再来执行，你看这个图形就大一点了，看到了吗，这个图形就大一点了，它是怎么一点一点去近的，看到了吧，一开始我们无论随机数的这个红色的点，它在左边也好，还是在右边也好，使用梯度下降。

是不是都是可以一步一步一步一步，达到咱们的最优解呀，对不对，看到了吧，他都可以啊，你看这回是11，你看我们再执行一下，看这回是九也能也能够。



![](img/35cc1e9dc02965cd00cdb1de63891075_64.png)

是不是再来执行一下，再来执行啊，咱们让他再看这回呃。

![](img/35cc1e9dc02965cd00cdb1de63891075_66.png)

随机数执行，我们让它生成在左边啊。

![](img/35cc1e9dc02965cd00cdb1de63891075_68.png)

哎生连续生成好几次，是不是都在右边诶。

![](img/35cc1e9dc02965cd00cdb1de63891075_70.png)

奇了怪了，邪了门了，来再来执行，哎你看这回是不是就在左边了，无论在左边在右边，根据咱们梯度下降的公式，它都可以以最快的速度走到哪儿，走到咱们。



![](img/35cc1e9dc02965cd00cdb1de63891075_72.png)

你看走到这里，而且我们执行的次数还不多，看到了吧。

![](img/35cc1e9dc02965cd00cdb1de63891075_74.png)

执行的次数不多，执行的次数跟什么有关，是不是跟咱们的斜率呀。

![](img/35cc1e9dc02965cd00cdb1de63891075_76.png)

对不对，我们把斜率调整成0。3，这回你看是不是就小了呀，你看一开始我们这个值是零，离我们的标准答案5。75老远了是吧，他只执行了梯度下降13步，是不是就找到了。



![](img/35cc1e9dc02965cd00cdb1de63891075_78.png)

各位各位，这段代码你一定要把它理解清楚。

![](img/35cc1e9dc02965cd00cdb1de63891075_80.png)

搞明白，知道吗，这一段代码while true死循环里面的代码。

![](img/35cc1e9dc02965cd00cdb1de63891075_82.png)

咱们在讲解这个代码执行的时候呢。

![](img/35cc1e9dc02965cd00cdb1de63891075_84.png)

我们把每一步变量什么意思是吧，都给大家讲的清清楚楚，明明白白，所以你要理解了这个。

![](img/35cc1e9dc02965cd00cdb1de63891075_86.png)